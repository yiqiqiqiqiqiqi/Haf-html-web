<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>World History Explorer</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            text-align: center;
            margin: 0;
            padding: 20px;
            background-image: url('https://images.unsplash.com/photo-1506318137071-a8e063b4bec0?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80');
            background-size: cover;
            background-attachment: fixed;
            background-position: center;
            color: #2c3e50;
            min-height: 100vh;
            overflow-x: hidden;
        }
        #game-container {
            max-width: 850px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.93);
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 0 25px rgba(0,0,0,0.25);
            backdrop-filter: blur(8px);
        }
        button {
            padding: 12px 28px;
            margin: 10px;
            font-size: 17px;
            cursor: pointer;
            background-color: #4a6fa5;
            color: white;
            border: none;
            border-radius: 10px;
            transition: all 0.3s;
            box-shadow: 0 4px 8px rgba(0,0,0,0.15);
            font-weight: bold;
            min-width: 120px;
        }
        button:hover:not(:disabled) {
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.2);
        }
        button:active:not(:disabled) {
            transform: translateY(1px);
        }
        button:disabled {
            background-color: #95a5a6;
            cursor: not-allowed;
        }
        #language-buttons {
            margin-bottom: 25px;
            display: flex;
            justify-content: center;
            gap: 10px;
        }
        #question, #score, #result, #mentor, #leaderboard, #hint, #progress, #explanation, #era-info, #streak-counter {
            margin: 20px 0;
            font-size: 19px;
            opacity: 0;
            animation: fadeIn 1s forwards;
        }
        #question {
            font-size: 22px;
            font-weight: bold;
            color: #2c3e50;
            min-height: 80px;
            display: flex;
            align-items: center;
            justify-content: center;
            line-height: 1.4;
        }
        #mentor img {
            width: 130px;
            height: 130px;
            border-radius: 50%;
            margin-top: 15px;
            transition: all 0.5s;
            border: 5px solid #4a6fa5;
            object-fit: cover;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        #mentor img:hover {
            transform: rotate(360deg);
            border-color: #e74c3c;
        }
        @keyframes fadeIn {
            to { opacity: 1; }
        }
        .shake {
            animation: shake 0.5s;
        }
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            75% { transform: translateX(10px); }
        }
        #leaderboard, #progress, #era-info, #streak-counter {
            background: rgba(233, 236, 239, 0.85);
            padding: 15px;
            border-radius: 10px;
            font-weight: bold;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        #choices button {
            display: block;
            width: 90%;
            margin: 15px auto;
            padding: 15px;
            text-align: center;
            font-size: 16px;
        }
        #explanation {
            font-size: 17px;
            color: #555;
            background: rgba(255, 255, 255, 0.8);
            padding: 20px;
            border-radius: 10px;
            border-left: 6px solid #4a6fa5;
            line-height: 1.6;
        }
        .civilization-tag {
            display: inline-block;
            padding: 6px 15px;
            margin: 8px;
            background-color: #6c757d;
            color: white;
            border-radius: 25px;
            font-size: 15px;
            font-weight: bold;
            transition: all 0.3s;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .civilization-tag:hover {
            background-color: #4a6fa5;
            transform: scale(1.05);
        }
        #timeline {
            height: 30px;
            background: linear-gradient(90deg, 
                #ff7675, #74b9ff, #55efc4, #ffeaa7, 
                #a29bfe, #fd79a8, #fdcb6e, #00b894);
            margin: 30px 0;
            border-radius: 15px;
            position: relative;
            box-shadow: 0 4px 8px rgba(0,0,0,0.15);
        }
        #timeline-marker {
            position: absolute;
            width: 18px;
            height: 40px;
            background: #2c3e50;
            top: -5px;
            left: 0;
            border-radius: 8px;
            box-shadow: 0 3px 6px rgba(0,0,0,0.25);
            transition: left 1s ease-in-out;
        }
        #timeline-labels {
            display: flex;
            justify-content: space-between;
            margin-top: 8px;
            font-size: 14px;
            font-weight: bold;
            color: #2c3e50;
        }
        #sound-controls {
            position: fixed;
            bottom: 25px;
            right: 25px;
            background: rgba(255,255,255,0.9);
            padding: 12px;
            border-radius: 50px;
            box-shadow: 0 3px 8px rgba(0,0,0,0.25);
            z-index: 100;
            display: flex;
            gap: 10px;
        }
        #sound-controls button {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            padding: 0;
            margin: 0;
            font-size: 22px;
            min-width: auto;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .correct {
            background-color: #2ecc71 !important;
            animation: pulseCorrect 0.5s;
        }
        .wrong {
            background-color: #e74c3c !important;
            animation: pulseWrong 0.5s;
        }
        @keyframes pulseCorrect {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        @keyframes pulseWrong {
            0% { transform: scale(1); }
            50% { transform: scale(0.95); }
            100% { transform: scale(1); }
        }
        #unlock-notification {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(135deg, #4a6fa5, #2ecc71);
            color: white;
            padding: 25px 50px;
            border-radius: 15px;
            font-size: 28px;
            font-weight: bold;
            z-index: 1000;
            display: none;
            box-shadow: 0 8px 25px rgba(0,0,0,0.3);
            animation: unlockFade 2.5s;
            text-align: center;
            border: 3px solid white;
        }
        @keyframes unlockFade {
            0% { opacity: 0; transform: translate(-50%, -50%) scale(0.7); }
            20% { opacity: 1; transform: translate(-50%, -50%) scale(1.1); }
            80% { opacity: 1; transform: translate(-50%, -50%) scale(1.1); }
            100% { opacity: 0; transform: translate(-50%, -50%) scale(0.8); }
        }
        #score-display {
            display: flex;
            justify-content: space-around;
            margin: 20px 0;
            gap: 20px;
        }
        #score-display > div {
            flex: 1;
            padding: 15px;
            border-radius: 10px;
            background: rgba(233, 236, 239, 0.85);
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        #mentor-bonus {
            font-size: 16px;
            color: #27ae60;
            font-style: italic;
            margin-top: 8px;
        }
        #streak-fire {
            color: #e74c3c;
            margin-left: 5px;
            display: none;
        }
        .difficulty-indicator {
            display: inline-block;
            width: 15px;
            height: 15px;
            border-radius: 50%;
            margin-left: 8px;
        }
        .difficulty-easy {
            background-color: #2ecc71;
        }
        .difficulty-medium {
            background-color: #f39c12;
        }
        .difficulty-hard {
            background-color: #e74c3c;
        }
        #question-counter {
            font-size: 16px;
            color: #7f8c8d;
            margin-top: 10px;
        }
        #achievements {
            position: fixed;
            top: 20px;
            left: 20px;
            background: rgba(255,255,255,0.9);
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 3px 8px rgba(0,0,0,0.2);
            z-index: 1050;
            max-width: 250px;
            display: none;
        }
        #achievements h3 {
            margin-top: 0;
            color: #4a6fa5;
            border-bottom: 2px solid #4a6fa5;
            padding-bottom: 8px;
        }
        .achievement-item {
            margin: 10px 0;
            padding: 8px;
            background: rgba(233, 236, 239, 0.7);
            border-radius: 5px;
            display: flex;
            align-items: center;
        }
        .achievement-icon {
            font-size: 24px;
            margin-right: 10px;
            color: #f39c12;
        }
        #achievement-badge {
            position: fixed;
            top: 20px;
            left: 20px;
            background: #e74c3c;
            color: white;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            cursor: pointer;
            box-shadow: 0 3px 8px rgba(0,0,0,0.3);
            z-index: 1051;
        }
        #question-timer {
            height: 5px;
            background: #ddd;
            margin: 15px 0;
            border-radius: 5px;
            overflow: hidden;
            display: none;
        }
        #timer-bar {
            height: 100%;
            width: 100%;
            background: #4a6fa5;
            transition: width 1s linear;
        }
        #settings-panel {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.3);
            z-index: 1100;
            display: none;
            max-width: 500px;
            width: 90%;
            animation: fadeInModal 0.3s ease-in-out;
        }
        #settings-backdrop {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1099;
            display: none;
        }
        #settings-panel h2 {
            margin-top: 0;
            color: #4a6fa5;
            border-bottom: 2px solid #4a6fa5;
            padding-bottom: 10px;
        }
        .settings-option {
            margin: 15px 0;
        }
        .settings-option label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
        }
        #close-settings {
            position: absolute;
            top: 15px;
            right: 15px;
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #7f8c8d;
        }
        #settings-button {
            position: fixed;
            bottom: 25px;
            left: 25px;
            background: rgba(255,255,255,0.9);
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            cursor: pointer;
            box-shadow: 0 3px 8px rgba(0,0,0,0.2);
            z-index: 100;
        }
        @keyframes fadeInModal {
            from { opacity: 0; transform: translate(-50%, -60%); }
            to { opacity: 1; transform: translate(-50%, -50%); }
        }
        @media (max-width: 600px) {
            #game-container {
                padding: 15px;
            }
            button {
                padding: 10px 20px;
                font-size: 15px;
                min-width: 100px;
            }
            #settings-panel {
                padding: 20px;
                width: 95%;
                max-width: 400px;
            }
            #question {
                font-size: 18px;
            }
            #sound-controls, #settings-button, #achievement-badge {
                transform: scale(0.8);
            }
        }
        .keyword-tag {
            background-color: #4a6fa5;
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: bold;
            transition: all 0.3s ease;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            text-decoration: none;
            display: inline-block;
        }
        .keyword-tag:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            background-color: #2c3e50;
            color: white;
            text-decoration: none;
        }
    </style>
</head>
<body>
    <div id="settings-backdrop"></div>
    <div id="game-container">
        <div id="logo-section" style="text-align: center; margin-bottom: 20px;">
            <a href="history.html"><img src="images/historylogo.png" alt="HAF Logo" style="max-width: 200px; height: auto; margin-bottom: 15px;"></a>
            <div id="keywords" style="display: flex; flex-wrap: wrap; justify-content: center; gap: 10px; margin: 10px 0;">
                <a href="history.html" class="keyword-tag">History</a>
                <a href="world_history.html" class="keyword-tag">World History</a>
                <a href="malaysia_history.html" class="keyword-tag">Malaysia History</a>
                <a href="history_game.html" class="keyword-tag">History Game</a>
                <a href="art.html" class="keyword-tag">Art</a>
                <a href="fashion.html" class="keyword-tag">Fashion</a>
            </div>
        </div>
        <div id="language-buttons">
            <button onclick="setLanguage('zh')" aria-label="Switch to Chinese">‰∏≠Êñá</button>
            <button onclick="setLanguage('en')" aria-label="Switch to English">English</button>
            <button onclick="setLanguage('ja')" aria-label="Switch to Japanese">Êó•Êú¨Ë™û</button>
        </div>
        <h1 id="title">World History Explorer</h1>
        
        <div id="timeline">
            <div id="timeline-marker"></div>
        </div>
        <div id="timeline-labels">
            <span>Ancient</span>
            <span>Classical</span>
            <span>Middle Ages</span>
            <span>Early Modern</span>
            <span>Modern</span>
        </div>
        
        <div id="era-info">Current Era: Ancient Civilizations</div>
        <div id="question-timer"><div id="timer-bar"></div></div>
        <div id="mentor">Mentor: Not selected<br><img id="mentor-img" src="" style="display: none;"></div>
        
        <div id="score-display">
            <div id="score">Score: 0</div>
            <div id="leaderboard">High Score: 0</div>
            <div id="streak-counter">Streak: 0</div>
        </div>
        
        <div id="progress">Unlocked Civilizations: Mesopotamia, Ancient Egypt</div>
        <div id="question">Click "New Question" to start exploring!</div>
        <div id="hint"></div>
        <div id="choices"></div>
        <div id="result"></div>
        <div id="explanation"></div>
        <div id="question-counter">Questions Answered: 0</div>
        
        <div>
            <button id="next-question" onclick="debouncedNextQuestion()" aria-label="Get New Question">New Question</button>
            <button id="hint-button" onclick="showHint()" style="background-color: #27ae60;" aria-label="Show Hint">Hint</button>
            <button id="reset-score" onclick="resetScore()" style="background-color: #e74c3c;" aria-label="Reset Score">Reset Score</button>
        </div>
    </div>

    <div id="sound-controls">
        <button id="music-toggle" onclick="toggleMusic()" aria-label="Toggle Music">üéµ</button>
        <button id="sound-toggle" onclick="toggleSound()" aria-label="Toggle Sound">üîä</button>
    </div>

    <div id="achievement-badge" onclick="toggleAchievements()" title="View Achievements" aria-label="View Achievements">üèÜ</div>
    
    <div id="achievements">
        <h3 id="achievements-title">Achievements</h3>
        <div id="achievements-list"></div>
    </div>

    <div id="settings-button" onclick="showSettings()" title="Open Settings" aria-label="Open Settings">‚öôÔ∏è</div>
    
    <div id="settings-panel" role="dialog" aria-labelledby="settings-title">
        <button id="close-settings" onclick="hideSettings()" aria-label="Close Settings">√ó</button>
        <h2 id="settings-title">Settings</h2>
        <div class="settings-option">
            <label id="music-label">Background Music</label>
            <button onclick="toggleMusic()" id="music-toggle-setting" aria-label="Toggle Background Music">Disable Music</button>
        </div>
        <div class="settings-option">
            <label id="sound-label">Sound Effects</label>
            <button onclick="toggleSound()" id="sound-toggle-setting" aria-label="Toggle Sound Effects">Disable Sound</button>
        </div>
        <div class="settings-option">
            <label id="timer-label">Question Timer</label>
            <button onclick="toggleTimer()" id="timer-toggle-setting" aria-label="Toggle Question Timer">Disable Timer</button>
        </div>
        <div class="settings-option">
            <label id="difficulty-label">Difficulty Level</label>
            <select id="difficulty-select" aria-label="Select Difficulty">
                <option value="easy">Easy</option>
                <option value="medium" selected>Medium</option>
                <option value="hard">Hard</option>
            </select>
        </div>
    </div>

    <div id="unlock-notification"></div>

    <!-- Audio System -->
    <audio id="bg-music" preload="auto" loop>
        <source src="https://assets.mixkit.co/music/preview/mixkit-epic-historic-adventure-1497.mp3" type="audio/mpeg">
    </audio>
    <audio id="success-sound" preload="auto">
        <source src="https://assets.mixkit.co/sfx/preview/mixkit-achievement-bell-600.mp3" type="audio/mpeg">
    </audio>
    <audio id="fail-sound" preload="auto">
        <source src="https://assets.mixkit.co/sfx/preview/mixkit-wrong-answer-fail-notification-946.mp3" type="audio/mpeg">
    </audio>
    <audio id="hint-sound" preload="auto">
        <source src="https://assets.mixkit.co/sfx/preview/mixkit-magic-sparkle-902.mp3" type="audio/mpeg">
    </audio>
    <audio id="page-sound" preload="auto">
        <source src="https://assets.mixkit.co/sfx/preview/mixkit-book-page-turning-1561.mp3" type="audio/mpeg">
    </audio>
    <audio id="unlock-sound" preload="auto">
        <source src="https://assets.mixkit.co/sfx/preview/mixkit-unlock-game-notification-253.mp3" type="audio/mpeg">
    </audio>
    <audio id="button-sound" preload="auto">
        <source src="https://assets.mixkit.co/sfx/preview/mixkit-select-click-1109.mp3" type="audio/mpeg">
    </audio>
    <audio id="correct-sound" preload="auto">
        <source src="https://assets.mixkit.co/sfx/preview/mixkit-correct-answer-tone-2870.mp3" type="audio/mpeg">
    </audio>
    <audio id="wrong-sound" preload="auto">
        <source src="https://assets.mixkit.co/sfx/preview/mixkit-wrong-electric-buzz-2927.mp3" type="audio/mpeg">
    </audio>
    <audio id="era-change-sound" preload="auto">
        <source src="https://assets.mixkit.co/sfx/preview/mixkit-ominous-drums-561.mp3" type="audio/mpeg">
    </audio>
    <audio id="achievement-sound" preload="auto">
        <source src="https://assets.mixkit.co/sfx/preview/mixkit-achievement-completed-2068.mp3" type="audio/mpeg">
    </audio>
    <audio id="streak-sound" preload="auto">
        <source src="https://assets.mixkit.co/sfx/preview/mixkit-positive-interface-beep-221.mp3" type="audio/mpeg">
    </audio>

    <script>
        // Initialize score and highScore from localStorage
        let score = localStorage.getItem('score_1.0') ? parseInt(localStorage.getItem('score_1.0')) : 0;
        let highScore = localStorage.getItem('highScore_1.0') ? parseInt(localStorage.getItem('highScore_1.0')) : 0;

        // Game State
        let currentQuestion = null;
        let language = 'en';
        let currentMentor = null;
        let correctAnswers = 0;
        let unlockedCivilizations = ['Mesopotamia', 'Ancient Egypt'];
        let currentEra = 'Ancient Civilizations';
        let timelinePosition = 0;
        let musicEnabled = true;
        let soundEnabled = true;
        let currentStreak = 0;
        let highestStreak = 0;
        let totalQuestionsAnswered = 0;
        let timerEnabled = false;
        let timerInterval;
        let difficulty = 'medium';
        let isProcessing = false;
        let questionHistory = [];

        const translations = {
            title: { en: 'World History Explorer', zh: '‰∏ñÁïåÂéÜÂè≤Êé¢Èô©ÂÆ∂', ja: '‰∏ñÁïåÊ≠¥Âè≤Êé¢Ê§úËÄÖ' },
            newQuestion: { en: 'New Question', zh: 'Êñ∞ÈóÆÈ¢ò', ja: 'Êñ∞„Åó„ÅÑË≥™Âïè' },
            hint: { en: 'Hint', zh: 'ÊèêÁ§∫', ja: '„Éí„É≥„Éà' },
            resetScore: { en: 'Reset Score', zh: 'ÈáçÁΩÆÂàÜÊï∞', ja: '„Çπ„Ç≥„Ç¢„Çí„É™„Çª„ÉÉ„Éà' },
            settings: { en: 'Settings', zh: 'ËÆæÁΩÆ', ja: 'Ë®≠ÂÆö' },
            musicLabel: { en: 'Background Music', zh: 'ËÉåÊôØÈü≥‰πê', ja: 'ËÉåÊôØÈü≥Ê•Ω' },
            soundLabel: { en: 'Sound Effects', zh: 'Èü≥Êïà', ja: 'ÂäπÊûúÈü≥' },
            timerLabel: { en: 'Question Timer', zh: 'ÈóÆÈ¢òËÆ°Êó∂Âô®', ja: 'Ë≥™Âïè„Çø„Ç§„Éû„Éº' },
            difficultyLabel: { en: 'Difficulty Level', zh: 'ÈöæÂ∫¶Á∫ßÂà´', ja: 'Èõ£ÊòìÂ∫¶' },
            achievements: { en: 'Achievements', zh: 'ÊàêÂ∞±', ja: 'ÂÆüÁ∏æ' },
            score: { en: 'Score', zh: 'ÂàÜÊï∞', ja: '„Çπ„Ç≥„Ç¢' },
            highScore: { en: 'High Score', zh: 'ÊúÄÈ´òÂàÜ', ja: '„Éè„Ç§„Çπ„Ç≥„Ç¢' },
            streak: { en: 'Streak', zh: 'ËøûËÉú', ja: 'ÈÄ£Á∂öÊ≠£Ëß£' },
            unlockedCivs: { en: 'Unlocked Civilizations', zh: 'Ëß£ÈîÅÁöÑÊñáÊòé', ja: 'Ëß£Êîæ„Åï„Çå„ÅüÊñáÊòé' },
            currentEra: { en: 'Current Era', zh: 'ÂΩìÂâçÊó∂‰ª£', ja: 'ÁèæÂú®„ÅÆÊôÇ‰ª£' },
            questionsAnswered: { en: 'Questions Answered', zh: 'Â∑≤ÂõûÁ≠îÈóÆÈ¢ò', ja: 'ÂõûÁ≠î„Åó„ÅüË≥™Âïè' },
            noQuestions: { en: 'No more questions! Try unlocking more civilizations or eras.', zh: 'Ê≤°ÊúâÊõ¥Â§öÈóÆÈ¢òÔºÅÂ∞ùËØïËß£ÈîÅÊõ¥Â§öÊñáÊòéÊàñÊó∂‰ª£„ÄÇ', ja: '„Åì„Çå‰ª•‰∏ä„ÅÆË≥™Âïè„ÅØ„ÅÇ„Çä„Åæ„Åõ„ÇìÔºÅ„Åï„Çâ„Å´ÊñáÊòé„ÇÑÊôÇ‰ª£„ÇíËß£Êîæ„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ' },
            scoreReset: { en: 'Score reset!', zh: 'ÂàÜÊï∞Â∑≤ÈáçÁΩÆÔºÅ', ja: '„Çπ„Ç≥„Ç¢„Åå„É™„Çª„ÉÉ„Éà„Åï„Çå„Åæ„Åó„ÅüÔºÅ' },
            mentorNotSelected: { en: 'Mentor: Not selected', zh: 'ÂØºÂ∏àÔºöÊú™ÈÄâÊã©', ja: 'ÊåáÂ∞éËÄÖÔºöÊú™ÈÅ∏Êäû' },
            selectMentor: { en: 'Select Mentor', zh: 'ÈÄâÊã©ÂØºÂ∏à', ja: 'ÊåáÂ∞éËÄÖ„ÇíÈÅ∏Êäû' },
            noMentorHint: { en: 'Hint: Please select a mentor first', zh: 'ÊèêÁ§∫ÔºöËØ∑ÂÖàÈÄâÊã©‰∏Ä‰ΩçÂØºÂ∏à', ja: '„Éí„É≥„ÉàÔºö„Åæ„ÅöÊåáÂ∞éËÄÖ„ÇíÈÅ∏Êäû„Åó„Å¶„Åè„Å†„Åï„ÅÑ' },
            noQuestionHint: { en: 'Hint: Please start a question first', zh: 'ÊèêÁ§∫ÔºöËØ∑ÂÖàÂºÄÂßã‰∏Ä‰∏™ÈóÆÈ¢ò', ja: '„Éí„É≥„ÉàÔºö„Åæ„ÅöË≥™Âïè„ÇíÂßã„ÇÅ„Å¶„Åè„Å†„Åï„ÅÑ' },
            correct: { en: 'Correct! Earned {points} points (Streak x{streak})', zh: 'Ê≠£Á°ÆÔºÅËé∑Âæó {points} ÂàÜÔºàËøûËÉú x{streak}Ôºâ', ja: 'Ê≠£Ëß£ÔºÅ{points} „Éù„Ç§„É≥„ÉàÁç≤ÂæóÔºàÈÄ£Á∂ö x{streak}Ôºâ' },
            wrong: { en: 'Wrong!', zh: 'ÈîôËØØÔºÅ', ja: '‰∏çÊ≠£Ëß£ÔºÅ' },
            civUnlocked: { en: 'New civilization unlocked: {civ}', zh: 'Êñ∞ÊñáÊòéËß£ÈîÅÔºö{civ}', ja: 'Êñ∞„Åó„ÅÑÊñáÊòé„ÅåËß£Êîæ„Åï„Çå„Åæ„Åó„ÅüÔºö{civ}' },
            eraUnlocked: { en: 'New era unlocked: {era}', zh: 'Êñ∞Êó∂‰ª£Ëß£ÈîÅÔºö{era}', ja: 'Êñ∞„Åó„ÅÑÊôÇ‰ª£„ÅåËß£Êîæ„Åï„Çå„Åæ„Åó„ÅüÔºö{era}' },
            achievementUnlocked: { en: 'Achievement Unlocked: {name}', zh: 'ÊàêÂ∞±Ëß£ÈîÅÔºö{name}', ja: 'ÂÆüÁ∏æËß£ÊîæÔºö{name}' }
        };

        const achievements = {
            firstAnswer: { 
                earned: false, 
                name: { en: 'First Answer', zh: 'È¶ñÊ¨°ÂõûÁ≠î', ja: 'ÂàùÂõûÁ≠î' }, 
                desc: { en: 'Answer your first question', zh: 'ÂõûÁ≠î‰Ω†ÁöÑÁ¨¨‰∏Ä‰∏™ÈóÆÈ¢ò', ja: 'ÊúÄÂàù„ÅÆË≥™Âïè„Å´Á≠î„Åà„Çã' } 
            },
            fiveStreak: { 
                earned: false, 
                name: { en: 'Five Streak', zh: '‰∫îËøûËÉú', ja: '5ÈÄ£Á∂öÊ≠£Ëß£' }, 
                desc: { en: 'Answer 5 questions correctly in a row', zh: 'ËøûÁª≠Ê≠£Á°ÆÂõûÁ≠î5‰∏™ÈóÆÈ¢ò', ja: '5ÂïèÈÄ£Á∂ö„ÅßÊ≠£Ëß£„Åô„Çã' } 
            },
            unlockAll: { 
                earned: false, 
                name: { en: 'Unlock Master', zh: 'Ëß£ÈîÅÂ§ßÂ∏à', ja: 'Ëß£Êîæ„Éû„Çπ„Çø„Éº' }, 
                desc: { en: 'Unlock all civilizations and eras', zh: 'Ëß£ÈîÅÊâÄÊúâÊñáÊòéÂíåÊó∂‰ª£', ja: '„Åô„Åπ„Å¶„ÅÆÊñáÊòé„Å®ÊôÇ‰ª£„ÇíËß£Êîæ„Åô„Çã' } 
            },
            perfectScore: { 
                earned: false, 
                name: { en: 'Perfect Score', zh: 'ÂÆåÁæéÂàÜÊï∞', ja: 'ÂÆåÁíß„Å™„Çπ„Ç≥„Ç¢' }, 
                desc: { en: 'Reach 1000 points', zh: 'ËææÂà∞1000ÂàÜ', ja: '1000„Éù„Ç§„É≥„Éà„Å´Âà∞ÈÅî„Åô„Çã' } 
            },
            historyBuff: { 
                earned: false, 
                name: { en: 'History Buff', zh: 'ÂéÜÂè≤Áà±Â•ΩËÄÖ', ja: 'Ê≠¥Âè≤ÊÑõÂ•ΩÂÆ∂' }, 
                desc: { en: 'Answer 50 questions', zh: 'ÂõûÁ≠î50‰∏™ÈóÆÈ¢ò', ja: '50Âïè„Å´Á≠î„Åà„Çã' } 
            }
        };

        const mentors = {
            herodotus: { 
                name: { en: 'Herodotus', zh: 'Â∏åÁΩóÂ§öÂæ∑', ja: '„Éò„É≠„Éâ„Éà„Çπ' }, 
                bonus: 1.3,
                hintStyle: { en: 'Father of History says: ', zh: 'ÂéÜÂè≤‰πãÁà∂ËØ¥Ôºö', ja: 'Ê≠¥Âè≤„ÅÆÁà∂„ÅØË®Ä„ÅÜÔºö' },
                img: 'https://upload.wikimedia.org/wikipedia/commons/thumb/d/dd/Herodotus_Met_91.8.jpg/220px-Herodotus_Met_91.8.jpg',
                specialty: ['Ancient Greece', 'Ancient Persia'],
                quote: { en: '"History is the record of human actions"', zh: '‚ÄúÂéÜÂè≤ÊòØ‰∫∫Á±ªË°å‰∏∫ÁöÑËÆ∞ÂΩï‚Äù', ja: '„ÄåÊ≠¥Âè≤„ÅØ‰∫∫Èñì„ÅÆË°åÂãï„ÅÆË®òÈå≤„Åß„ÅÇ„Çã„Äç' }
            },
            simaqian: { 
                name: { en: 'Sima Qian', zh: 'Âè∏È©¨ËøÅ', ja: 'Âè∏È¶¨ÈÅ∑' }, 
                bonus: 1.4,
                hintStyle: { en: 'Grand Historian notes: ', zh: 'Â§ßÂè≤Â≠¶ÂÆ∂ËÆ∞ÂΩïÔºö', ja: 'Â§ßÊ≠¥Âè≤ÂÆ∂„ÅØË®ò„ÅôÔºö' },
                img: 'https://upload.wikimedia.org/wikipedia/commons/thumb/5/5f/Sima_Qian.jpg/220px-Sima_Qian.jpg',
                specialty: ['Ancient China', 'Han Dynasty'],
                quote: { en: '"To explore the relation between heaven and man"', zh: '‚ÄúÊé¢Á¥¢Â§©‰∫∫ÂÖ≥Á≥ª‚Äù', ja: '„ÄåÂ§©„Å®‰∫∫„ÅÆÈñ¢‰øÇ„ÇíÊé¢„Çã„Äç' }
            },
            ibnkhaldun: { 
                name: { en: 'Ibn Khaldun', zh: '‰ºäÊú¨¬∑Ëµ´ÂãíÊï¶', ja: '„Ç§„Éñ„É≥„Éª„Éè„É´„Éâ„Ç•„Éº„É≥' }, 
                bonus: 1.5,
                hintStyle: { en: 'Father of Sociology suggests: ', zh: 'Á§æ‰ºöÂ≠¶‰πãÁà∂Âª∫ËÆÆÔºö', ja: 'Á§æ‰ºöÂ≠¶„ÅÆÁà∂„ÅØÊèêÊ°à„Åô„ÇãÔºö' },
                img: 'https://upload.wikimedia.org/wikipedia/commons/thumb/7/7e/Ibn_Khaldun.jpg/220px-Ibn_Khaldun.jpg',
                specialty: ['Islamic Civilization', 'Middle Ages'],
                quote: { en: '"History is the mirror of human society"', zh: '‚ÄúÂéÜÂè≤ÊòØ‰∫∫Á±ªÁ§æ‰ºöÁöÑÈïúÂ≠ê‚Äù', ja: '„ÄåÊ≠¥Âè≤„ÅØ‰∫∫ÈñìÁ§æ‰ºö„ÅÆÈè°„Åß„ÅÇ„Çã„Äç' }
            }
        };

        const eras = [
            { 
                name: { en: 'Ancient Civilizations', zh: 'Âè§‰ª£ÊñáÊòé', ja: 'Âè§‰ª£ÊñáÊòé' }, 
                civilizations: ['Mesopotamia', 'Ancient Egypt', 'Ancient India', 'Ancient China'], 
                position: 0,
                color: '#ff7675' 
            },
            { 
                name: { en: 'Classical Age', zh: 'Âè§ÂÖ∏Êó∂‰ª£', ja: 'Âè§ÂÖ∏ÊôÇ‰ª£' }, 
                civilizations: ['Ancient Greece', 'Ancient Rome', 'Persian Empire', 'Qin-Han'], 
                position: 25,
                color: '#74b9ff' 
            },
            { 
                name: { en: 'Middle Ages', zh: '‰∏≠‰∏ñÁ∫™', ja: '‰∏≠‰∏ñ' }, 
                civilizations: ['Byzantine', 'Islamic Civilization', 'Tang-Song', 'Feudal Europe'], 
                position: 50,
                color: '#55efc4' 
            },
            { 
                name: { en: 'Early Modern', zh: 'Êó©ÊúüÁé∞‰ª£', ja: 'Ëøë‰∏ñ' }, 
                civilizations: ['Renaissance', 'Age of Exploration', 'Ming-Qing', 'Ottoman'], 
                position: 75,
                color: '#ffeaa7' 
            },
            { 
                name: { en: 'Modern World', zh: 'Áé∞‰ª£‰∏ñÁïå', ja: 'Áèæ‰ª£‰∏ñÁïå' }, 
                civilizations: ['Industrial Revolution', 'Colonial Era', 'World Wars', 'Contemporary'], 
                position: 100,
                color: '#a29bfe' 
            }
        ];

        const questions = [
            {
                civilizations: ['Mesopotamia'],
                era: 'Ancient Civilizations',
                question: { 
                    en: 'Which civilization developed the world\'s earliest known writing system?', 
                    zh: 'Âì™‰∏™ÊñáÊòéÂèëÂ±ï‰∫Ü‰∏ñÁïå‰∏äÂ∑≤Áü•ÁöÑÊúÄÊó©‰π¶ÂÜôÁ≥ªÁªüÔºü', 
                    ja: '‰∏ñÁïå„ÅßÊúÄ„ÇÇÂè§„ÅÑÊó¢Áü•„ÅÆÊñáÂ≠ó‰ΩìÁ≥ª„ÇíÈñãÁô∫„Åó„ÅüÊñáÊòé„ÅØ„Å©„ÇåÔºü' 
                },
                choices: { 
                    en: ['Ancient Egypt', 'Mesopotamia', 'Ancient India', 'Ancient China'], 
                    zh: ['Âè§ÂüÉÂèä', 'ÁæéÁ¥¢‰∏çËææÁ±≥‰∫ö', 'Âè§Âç∞Â∫¶', 'Âè§‰∏≠ÂõΩ'], 
                    ja: ['Âè§‰ª£„Ç®„Ç∏„Éó„Éà', '„É°„ÇΩ„Éù„Çø„Éü„Ç¢', 'Âè§‰ª£„Ç§„É≥„Éâ', 'Âè§‰ª£‰∏≠ÂõΩ'] 
                },
                answer: 1,
                explanation: { 
                    en: 'The Sumerians of Mesopotamia developed cuneiform script around 3400 BCE, the earliest known writing system.', 
                    zh: 'ÁæéÁ¥¢‰∏çËææÁ±≥‰∫öÁöÑËãèÁæéÂ∞î‰∫∫‰∫éÂÖ¨ÂÖÉÂâç3400Âπ¥Â∑¶Âè≥ÂèëÂ±ï‰∫ÜÊ•îÂΩ¢ÊñáÂ≠óÔºåËøôÊòØÂ∑≤Áü•ÁöÑÊúÄÊó©‰π¶ÂÜôÁ≥ªÁªü„ÄÇ', 
                    ja: '„É°„ÇΩ„Éù„Çø„Éü„Ç¢„ÅÆ„Ç∑„É•„É°„Éº„É´‰∫∫„ÅØÁ¥ÄÂÖÉÂâç3400Âπ¥È†É„Å´Ê•îÂΩ¢ÊñáÂ≠ó„ÇíÈñãÁô∫„Åó„ÄÅ„Åì„Çå„ÅØÊó¢Áü•„ÅÆÊúÄÂè§„ÅÆÊñáÂ≠ó‰ΩìÁ≥ª„Åß„Åô„ÄÇ' 
                },
                difficulty: 1
            },
            {
                civilizations: ['Ancient Egypt'],
                era: 'Ancient Civilizations',
                question: {
                    en: 'Which pharaoh built the Great Pyramid of Giza?',
                    zh: 'Âì™‰ΩçÊ≥ïËÄÅÂª∫ÈÄ†‰∫ÜÂêâËê®Â§ßÈáëÂ≠óÂ°îÔºü',
                    ja: '„ÇÆ„Ç∂„ÅÆÂ§ß„Éî„É©„Éü„ÉÉ„Éâ„ÇíÂª∫Ë®≠„Åó„Åü„Éï„Ç°„É©„Ç™„ÅØË™∞Ôºü'
                },
                choices: {
                    en: ['Ramses II', 'Khufu', 'Tutankhamun', 'Cleopatra'],
                    zh: ['ÊãâÁæéË•øÊñØ‰∫å‰∏ñ', 'ËÉ°Â§´', 'ÂõæÂù¶Âç°Ëíô', 'ÂÖãÂà©Â••Â∏ïÁâπÊãâ'],
                    ja: ['„É©„É†„Çª„Çπ2‰∏ñ', '„ÇØ„ÉïÁéã', '„ÉÑ„Çø„É≥„Ç´„Éº„É°„É≥', '„ÇØ„É¨„Ç™„Éë„Éà„É©']
                },
                answer: 1,
                explanation: {
                    en: 'Khufu (also known as Cheops) built the Great Pyramid of Giza around 2560 BCE.',
                    zh: 'ËÉ°Â§´Ôºà‰πüÁß∞‰∏∫Âü∫Â••ÊôÆÊñØÔºâÂú®ÂÖ¨ÂÖÉÂâç2560Âπ¥Â∑¶Âè≥Âª∫ÈÄ†‰∫ÜÂêâËê®Â§ßÈáëÂ≠óÂ°î„ÄÇ',
                    ja: '„ÇØ„ÉïÁéãÔºà„Ç±„Ç™„Éó„Çπ„Å®„Åó„Å¶„ÇÇÁü•„Çâ„Çå„ÇãÔºâ„ÅØÁ¥ÄÂÖÉÂâç2560Âπ¥È†É„Å´„ÇÆ„Ç∂„ÅÆÂ§ß„Éî„É©„Éü„ÉÉ„Éâ„ÇíÂª∫Ë®≠„Åó„Åæ„Åó„Åü„ÄÇ'
                },
                difficulty: 1
            },
            {
                civilizations: ['Ancient Egypt'],
                era: 'Ancient Civilizations',
                question: {
                    en: 'What was the purpose of the Rosetta Stone?',
                    zh: 'ÁΩóÂ°ûÂ°îÁü≥Á¢ëÁöÑÁî®ÈÄîÊòØ‰ªÄ‰πàÔºü',
                    ja: '„É≠„Çº„ÉÉ„Çø„Éª„Çπ„Éà„Éº„É≥„ÅÆÁõÆÁöÑ„ÅØ‰ΩïÔºü'
                },
                choices: {
                    en: ['Religious text', 'Decree of Ptolemy V', 'Tomb decoration', 'Temple record'],
                    zh: ['ÂÆóÊïôÊñáÊú¨', 'ÊâòÂãíÂØÜ‰∫î‰∏ñÊ≥ï‰ª§', 'ÈôµÂ¢ìË£ÖÈ•∞', 'Á•ûÂ∫ôËÆ∞ÂΩï'],
                    ja: ['ÂÆóÊïôÊñáÊõ∏', '„Éó„Éà„É¨„Éû„Ç§„Ç™„Çπ5‰∏ñ„ÅÆÂãÖ‰ª§', 'Â¢ì„ÅÆË£ÖÈ£æ', 'Á•ûÊÆø„ÅÆË®òÈå≤']
                },
                answer: 1,
                explanation: {
                    en: 'The Rosetta Stone contained a decree issued by Ptolemy V in 196 BCE, written in three scripts.',
                    zh: 'ÁΩóÂ°ûÂ°îÁü≥Á¢ëÂåÖÂê´‰∫ÜÂÖ¨ÂÖÉÂâç196Âπ¥ÊâòÂãíÂØÜ‰∫î‰∏ñÈ¢ÅÂ∏ÉÁöÑÊ≥ï‰ª§ÔºåÁî®‰∏âÁßçÊñáÂ≠ó‰π¶ÂÜô„ÄÇ',
                    ja: '„É≠„Çº„ÉÉ„Çø„Éª„Çπ„Éà„Éº„É≥„Å´„ÅØÁ¥ÄÂÖÉÂâç196Âπ¥„Å´„Éó„Éà„É¨„Éû„Ç§„Ç™„Çπ5‰∏ñ„ÅåÁô∫Â∏É„Åó„ÅüÂãÖ‰ª§„Åå3„Å§„ÅÆÊñáÂ≠ó„ÅßË®ò„Åï„Çå„Å¶„ÅÑ„Åæ„Åô„ÄÇ'
                },
                difficulty: 2
            },
            {
                civilizations: ['Ancient Egypt'],
                era: 'Ancient Civilizations',
                question: {
                    en: 'Which Egyptian queen was known for her relationship with Julius Caesar and Mark Antony?',
                    zh: 'Âì™‰ΩçÂüÉÂèäÂ•≥Áéã‰ª•‰∏éÂ∞§Âà©‰πåÊñØ¬∑ÂáØÊííÂíåÈ©¨ÂÖã¬∑ÂÆâ‰∏úÂ∞ºÁöÑÂÖ≥Á≥ªËÄåÈóªÂêçÔºü',
                    ja: '„É¶„É™„Ç¶„Çπ„Éª„Ç´„Ç®„Çµ„É´„Å®„Éû„É´„ÇØ„Çπ„Éª„Ç¢„É≥„Éà„Éã„Ç¶„Çπ„Å®„ÅÆÈñ¢‰øÇ„ÅßÁü•„Çâ„Çå„Çã„Ç®„Ç∏„Éó„Éà„ÅÆÂ•≥Áéã„ÅØË™∞Ôºü'
                },
                choices: {
                    en: ['Nefertiti', 'Hatshepsut', 'Cleopatra', 'Nefertari'],
                    zh: ['Á∫≥ËäôËíÇËíÇ', 'ÂìàÁâπË∞¢ÊôÆËãèÁâπ', 'ÂÖãÂà©Â••Â∏ïÁâπÊãâ', 'Â•àËè≤Â∞îÂ°îÂà©'],
                    ja: ['„Éç„Éï„Çß„É´„ÉÜ„Ç£„ÉÜ„Ç£', '„Éè„Éà„Ç∑„Çß„Éó„Çπ„Éà', '„ÇØ„É¨„Ç™„Éë„Éà„É©', '„Éç„Éï„Çß„É´„Çø„É™']
                },
                answer: 2,
                explanation: {
                    en: 'Cleopatra VII was the last active ruler of the Ptolemaic Kingdom of Egypt.',
                    zh: 'ÂÖãÂà©Â••Â∏ïÁâπÊãâ‰∏É‰∏ñÊòØÊâòÂãíÂØÜÁéãÊúùÂüÉÂèäÁöÑÊúÄÂêé‰∏Ä‰ΩçÂÆûÈôÖÁªüÊ≤ªËÄÖ„ÄÇ',
                    ja: '„ÇØ„É¨„Ç™„Éë„Éà„É©7‰∏ñ„ÅØ„Éó„Éà„É¨„Éû„Ç§„Ç™„ÇπÊúù„Ç®„Ç∏„Éó„Éà„ÅÆÊúÄÂæå„ÅÆÂÆüË≥™ÁöÑ„Å™Áµ±Ê≤ªËÄÖ„Åß„Åó„Åü„ÄÇ'
                },
                difficulty: 1
            },
            {
                civilizations: ['Ancient Greece'],
                era: 'Classical Age',
                question: {
                    en: 'Which Greek city-state was known for its military society?',
                    zh: 'Âì™‰∏™Â∏åËÖäÂüéÈÇ¶‰ª•ÂÖ∂ÂÜõ‰∫ãÁ§æ‰ºöËÄåÈóªÂêçÔºü',
                    ja: 'Ëªç‰∫ãÁ§æ‰ºö„Å®„Åó„Å¶Áü•„Çâ„Çå„Çã„ÇÆ„É™„Ç∑„É£„ÅÆÈÉΩÂ∏ÇÂõΩÂÆ∂„ÅØ„Å©„ÇåÔºü'
                },
                choices: {
                    en: ['Athens', 'Sparta', 'Corinth', 'Thebes'],
                    zh: ['ÈõÖÂÖ∏', 'ÊñØÂ∑¥Ëææ', 'ÁßëÊûóÊñØ', 'Â∫ïÊØîÊñØ'],
                    ja: ['„Ç¢„ÉÜ„Éç', '„Çπ„Éë„É´„Çø', '„Ç≥„É™„É≥„Éà', '„ÉÜ„Éº„Éô']
                },
                answer: 1,
                explanation: {
                    en: 'Sparta was known for its military-focused society and the famous Spartan warriors.',
                    zh: 'ÊñØÂ∑¥Ëææ‰ª•ÂÖ∂‰ª•ÂÜõ‰∫ã‰∏∫‰∏≠ÂøÉÁöÑÁ§æ‰ºöÂíåËëóÂêçÁöÑÊñØÂ∑¥ËææÊàòÂ£´ËÄåÈóªÂêç„ÄÇ',
                    ja: '„Çπ„Éë„É´„Çø„ÅØËªç‰∫ã‰∏≠ÂøÉ„ÅÆÁ§æ‰ºö„Å®ÊúâÂêç„Å™„Çπ„Éë„É´„Çø„ÅÆÊà¶Â£´„ÅßÁü•„Çâ„Çå„Å¶„ÅÑ„Åæ„Åó„Åü„ÄÇ'
                },
                difficulty: 1
            },
            {
                civilizations: ['Ancient Greece'],
                era: 'Classical Age',
                question: {
                    en: 'Which Greek philosopher was the teacher of Alexander the Great?',
                    zh: 'Âì™‰ΩçÂ∏åËÖäÂì≤Â≠¶ÂÆ∂ÊòØ‰∫öÂéÜÂ±±Â§ßÂ§ßÂ∏ùÁöÑËÄÅÂ∏àÔºü',
                    ja: '„Ç¢„É¨„ÇØ„Çµ„É≥„ÉÄ„ÉºÂ§ßÁéã„ÅÆÂ∏´Âå†„Å®„Å™„Å£„Åü„ÇÆ„É™„Ç∑„É£„ÅÆÂì≤Â≠¶ËÄÖ„ÅØË™∞Ôºü'
                },
                choices: {
                    en: ['Socrates', 'Plato', 'Aristotle', 'Pythagoras'],
                    zh: ['ËãèÊ†ºÊãâÂ∫ï', 'ÊüèÊãâÂõæ', '‰∫öÈáåÂ£´Â§öÂæ∑', 'ÊØïËææÂì•ÊãâÊñØ'],
                    ja: ['„ÇΩ„ÇØ„É©„ÉÜ„Çπ', '„Éó„É©„Éà„É≥', '„Ç¢„É™„Çπ„Éà„ÉÜ„É¨„Çπ', '„Éî„Çø„Ç¥„É©„Çπ']
                },
                answer: 2,
                explanation: {
                    en: 'Aristotle was the tutor of Alexander the Great from 343 to 340 BCE.',
                    zh: '‰∫öÈáåÂ£´Â§öÂæ∑Âú®ÂÖ¨ÂÖÉÂâç343Âπ¥Ëá≥340Âπ¥Èó¥ÊãÖ‰ªª‰∫öÂéÜÂ±±Â§ßÂ§ßÂ∏ùÁöÑËÄÅÂ∏à„ÄÇ',
                    ja: '„Ç¢„É™„Çπ„Éà„ÉÜ„É¨„Çπ„ÅØÁ¥ÄÂÖÉÂâç343Âπ¥„Åã„Çâ340Âπ¥„Åæ„Åß„Ç¢„É¨„ÇØ„Çµ„É≥„ÉÄ„ÉºÂ§ßÁéã„ÅÆÂÆ∂Â∫≠ÊïôÂ∏´„ÇíÂãô„ÇÅ„Åæ„Åó„Åü„ÄÇ'
                },
                difficulty: 2
            },
            {
                civilizations: ['Ancient Greece'],
                era: 'Classical Age',
                question: {
                    en: 'Which Greek city hosted the first Olympic Games?',
                    zh: 'Âì™‰∏™Â∏åËÖäÂüéÂ∏Ç‰∏æÂäû‰∫ÜÁ¨¨‰∏ÄÂ±äÂ••Ëøê‰ºöÔºü',
                    ja: 'ÊúÄÂàù„ÅÆ„Ç™„É™„É≥„Éî„ÉÉ„ÇØÁ´∂ÊäÄ‰ºö„ÅåÈñãÂÇ¨„Åï„Çå„Åü„ÇÆ„É™„Ç∑„É£„ÅÆÈÉΩÂ∏Ç„ÅØ„Å©„ÅìÔºü'
                },
                choices: {
                    en: ['Athens', 'Sparta', 'Olympia', 'Delphi'],
                    zh: ['ÈõÖÂÖ∏', 'ÊñØÂ∑¥Ëææ', 'Â••ÊûóÂåπ‰∫ö', 'Âæ∑Â∞îÊñê'],
                    ja: ['„Ç¢„ÉÜ„Éç', '„Çπ„Éë„É´„Çø', '„Ç™„É™„É≥„Éî„Ç¢', '„Éá„É´„Éï„Ç©„Ç§']
                },
                answer: 2,
                explanation: {
                    en: 'The first Olympic Games were held in Olympia in 776 BCE.',
                    zh: 'Á¨¨‰∏ÄÂ±äÂ••Ëøê‰ºö‰∫éÂÖ¨ÂÖÉÂâç776Âπ¥Âú®Â••ÊûóÂåπ‰∫ö‰∏æË°å„ÄÇ',
                    ja: 'ÊúÄÂàù„ÅÆ„Ç™„É™„É≥„Éî„ÉÉ„ÇØÁ´∂ÊäÄ‰ºö„ÅØÁ¥ÄÂÖÉÂâç776Âπ¥„Å´„Ç™„É™„É≥„Éî„Ç¢„ÅßÈñãÂÇ¨„Åï„Çå„Åæ„Åó„Åü„ÄÇ'
                },
                difficulty: 1
            },
            {
                civilizations: ['Ancient Greece'],
                era: 'Classical Age',
                question: {
                    en: 'Which Greek mathematician is known for the Pythagorean theorem?',
                    zh: 'Âì™‰ΩçÂ∏åËÖäÊï∞Â≠¶ÂÆ∂‰ª•ÊØïËææÂì•ÊãâÊñØÂÆöÁêÜËÄåÈóªÂêçÔºü',
                    ja: '„Éî„Çø„Ç¥„É©„Çπ„ÅÆÂÆöÁêÜ„ÅßÁü•„Çâ„Çå„Çã„ÇÆ„É™„Ç∑„É£„ÅÆÊï∞Â≠¶ËÄÖ„ÅØË™∞Ôºü'
                },
                choices: {
                    en: ['Archimedes', 'Euclid', 'Pythagoras', 'Thales'],
                    zh: ['ÈòøÂü∫Á±≥Âæ∑', 'Ê¨ßÂá†ÈáåÂæó', 'ÊØïËææÂì•ÊãâÊñØ', 'Ê≥∞ÂãíÊñØ'],
                    ja: ['„Ç¢„É´„Ç≠„É°„Éá„Çπ', '„É¶„Éº„ÇØ„É™„ÉÉ„Éâ', '„Éî„Çø„Ç¥„É©„Çπ', '„Çø„É¨„Çπ']
                },
                answer: 2,
                explanation: {
                    en: 'Pythagoras (c. 570-495 BCE) is credited with the Pythagorean theorem in geometry.',
                    zh: 'ÊØïËææÂì•ÊãâÊñØÔºàÁ∫¶ÂÖ¨ÂÖÉÂâç570-495Âπ¥ÔºâÂõ†Âá†‰ΩïÂ≠¶‰∏≠ÁöÑÊØïËææÂì•ÊãâÊñØÂÆöÁêÜËÄåÈóªÂêç„ÄÇ',
                    ja: '„Éî„Çø„Ç¥„É©„ÇπÔºàÁ¥ÄÂÖÉÂâç570-495Âπ¥È†ÉÔºâ„ÅØÂπæ‰ΩïÂ≠¶„Å´„Åä„Åë„Çã„Éî„Çø„Ç¥„É©„Çπ„ÅÆÂÆöÁêÜ„ÅßÁü•„Çâ„Çå„Å¶„ÅÑ„Åæ„Åô„ÄÇ'
                },
                difficulty: 1
            },
            {
                civilizations: ['Ancient China'],
                era: 'Ancient Civilizations',
                question: {
                    en: 'Which Chinese dynasty is known for the construction of the Great Wall?',
                    zh: 'Âì™‰∏™Êúù‰ª£‰ª•Âª∫ÈÄ†ÈïøÂüéËÄåÈóªÂêçÔºü',
                    ja: '‰∏áÈáå„ÅÆÈï∑Âüé„ÅÆÂª∫Ë®≠„ÅßÁü•„Çâ„Çå„Çã‰∏≠ÂõΩ„ÅÆÁéãÊúù„ÅØ„Å©„ÇåÔºü'
                },
                choices: {
                    en: ['Han Dynasty', 'Qin Dynasty', 'Tang Dynasty', 'Ming Dynasty'],
                    zh: ['Ê±âÊúù', 'Áß¶Êúù', 'ÂîêÊúù', 'ÊòéÊúù'],
                    ja: ['Êº¢ÁéãÊúù', 'Áß¶ÁéãÊúù', 'ÂîêÁéãÊúù', 'ÊòéÁéãÊúù']
                },
                answer: 1,
                explanation: {
                    en: 'The Qin Dynasty (221-206 BCE) began the construction of the Great Wall to protect against northern invasions.',
                    zh: 'Áß¶ÊúùÔºàÂÖ¨ÂÖÉÂâç221-206Âπ¥ÔºâÂºÄÂßãÂª∫ÈÄ†ÈïøÂüé‰ª•ÊäµÂæ°ÂåóÊñπÂÖ•‰æµ„ÄÇ',
                    ja: 'Áß¶ÁéãÊúùÔºàÁ¥ÄÂÖÉÂâç221-206Âπ¥Ôºâ„ÅØÂåóÊñπ„Åã„Çâ„ÅÆ‰æµÁï•„ÇíÈò≤„Åê„Åü„ÇÅ„Å´‰∏áÈáå„ÅÆÈï∑Âüé„ÅÆÂª∫Ë®≠„ÇíÂßã„ÇÅ„Åæ„Åó„Åü„ÄÇ'
                },
                difficulty: 1
            },
            {
                civilizations: ['Ancient Rome'],
                era: 'Classical Age',
                question: {
                    en: 'Who was the first Roman Emperor?',
                    zh: 'Ë∞ÅÊòØÁ¨¨‰∏Ä‰ΩçÁΩóÈ©¨ÁöáÂ∏ùÔºü',
                    ja: 'ÊúÄÂàù„ÅÆ„É≠„Éº„ÉûÁöáÂ∏ù„ÅØË™∞Ôºü'
                },
                choices: {
                    en: ['Julius Caesar', 'Augustus', 'Nero', 'Constantine'],
                    zh: ['Â∞§Âà©‰πåÊñØ¬∑ÂáØÊíí', 'Â••Âè§ÊñØÈÉΩ', 'Â∞ºÁ¶Ñ', 'ÂêõÂ£´Âù¶‰∏Å'],
                    ja: ['„É¶„É™„Ç¶„Çπ„Éª„Ç´„Ç®„Çµ„É´', '„Ç¢„Ç¶„Ç∞„Çπ„Éà„Ç•„Çπ', '„Éç„É≠', '„Ç≥„É≥„Çπ„Çø„É≥„ÉÜ„Ç£„Éå„Çπ']
                },
                answer: 1,
                explanation: {
                    en: 'Augustus (27 BCE - 14 CE) was the first Roman Emperor, establishing the Roman Empire.',
                    zh: 'Â••Âè§ÊñØÈÉΩÔºàÂÖ¨ÂÖÉÂâç27Âπ¥-ÂÖ¨ÂÖÉ14Âπ¥ÔºâÊòØÁ¨¨‰∏Ä‰ΩçÁΩóÈ©¨ÁöáÂ∏ùÔºåÂª∫Á´ã‰∫ÜÁΩóÈ©¨Â∏ùÂõΩ„ÄÇ',
                    ja: '„Ç¢„Ç¶„Ç∞„Çπ„Éà„Ç•„ÇπÔºàÁ¥ÄÂÖÉÂâç27Âπ¥-Á¥ÄÂÖÉ14Âπ¥Ôºâ„ÅØÊúÄÂàù„ÅÆ„É≠„Éº„ÉûÁöáÂ∏ù„Åß„ÄÅ„É≠„Éº„ÉûÂ∏ùÂõΩ„ÇíÁ¢∫Á´ã„Åó„Åæ„Åó„Åü„ÄÇ'
                },
                difficulty: 2
            },
            {
                civilizations: ['Islamic Civilization'],
                era: 'Middle Ages',
                question: {
                    en: 'Which Islamic Golden Age scientist is known as the "Father of Algebra"?',
                    zh: 'Âì™‰Ωç‰ºäÊñØÂÖ∞ÈªÑÈáëÊó∂‰ª£ÁöÑÁßëÂ≠¶ÂÆ∂Ë¢´Áß∞‰∏∫"‰ª£Êï∞‰πãÁà∂"Ôºü',
                    ja: '„Äå‰ª£Êï∞Â≠¶„ÅÆÁà∂„Äç„Å®„Åó„Å¶Áü•„Çâ„Çå„Çã„Ç§„Çπ„É©„É†ÈªÑÈáëÊôÇ‰ª£„ÅÆÁßëÂ≠¶ËÄÖ„ÅØË™∞Ôºü'
                },
                choices: {
                    en: ['Ibn Sina', 'Al-Khwarizmi', 'Ibn Rushd', 'Al-Farabi'],
                    zh: ['‰ºäÊú¨¬∑Ë•øÈÇ£', 'Ëä±ÊãâÂ≠êÁ±≥', '‰ºäÊú¨¬∑È≤Å‰∏ñÂæ∑', 'Ê≥ïÊãâÊØî'],
                    ja: ['„Ç§„Éñ„É≥„Éª„Çπ„Ç£„Éº„Éä„Éº', '„Éï„ÉØ„Éº„É™„Ç∫„Éü„Éº', '„Ç§„Éñ„É≥„Éª„É´„Ç∑„É•„Éâ', '„Éï„Ç°„Éº„É©„Éº„Éì„Éº']
                },
                answer: 1,
                explanation: {
                    en: 'Al-Khwarizmi (c. 780-850) wrote the first comprehensive book on algebra.',
                    zh: 'Ëä±ÊãâÂ≠êÁ±≥ÔºàÁ∫¶780-850Âπ¥ÔºâÊí∞ÂÜô‰∫ÜÁ¨¨‰∏ÄÊú¨ÂÖ≥‰∫é‰ª£Êï∞ÁöÑÁªºÂêàÊÄßËëó‰Ωú„ÄÇ',
                    ja: '„Éï„ÉØ„Éº„É™„Ç∫„Éü„ÉºÔºà780-850Âπ¥È†ÉÔºâ„ÅØÊúÄÂàù„ÅÆÂåÖÊã¨ÁöÑ„Å™‰ª£Êï∞Â≠¶„ÅÆÊú¨„ÇíÊõ∏„Åç„Åæ„Åó„Åü„ÄÇ'
                },
                difficulty: 2
            },
            {
                civilizations: ['Renaissance'],
                era: 'Early Modern',
                question: {
                    en: 'Which Renaissance artist painted the ceiling of the Sistine Chapel?',
                    zh: 'Âì™‰ΩçÊñáËâ∫Â§çÂÖ¥Êó∂ÊúüÁöÑËâ∫ÊúØÂÆ∂ÁªòÂà∂‰∫ÜË•øÊñØÂª∑ÊïôÂ†ÇÁöÑÂ§©Ëä±ÊùøÔºü',
                    ja: '„Ç∑„Çπ„ÉÜ„Ç£„Éº„ÉäÁ§ºÊãùÂ†Ç„ÅÆÂ§©‰∫ï„ÇíÊèè„ÅÑ„Åü„É´„Éç„Çµ„É≥„Çπ„ÅÆËä∏Ë°ìÂÆ∂„ÅØË™∞Ôºü'
                },
                choices: {
                    en: ['Leonardo da Vinci', 'Michelangelo', 'Raphael', 'Donatello'],
                    zh: ['ÂàóÂ••Á∫≥Â§ö¬∑Ëææ¬∑Ëä¨Â•á', 'Á±≥ÂºÄÊúóÂü∫ÁΩó', 'ÊãâÊñêÂ∞î', 'Â§öÁ∫≥Ê≥∞ÁΩó'],
                    ja: ['„É¨„Ç™„Éä„É´„Éâ„Éª„ÉÄ„Éª„É¥„Ç£„É≥„ÉÅ', '„Éü„Ç±„É©„É≥„Ç∏„Çß„É≠', '„É©„Éï„Ç°„Ç®„É≠', '„Éâ„Éä„ÉÜ„ÉÉ„É≠']
                },
                answer: 1,
                explanation: {
                    en: 'Michelangelo painted the Sistine Chapel ceiling between 1508 and 1512.',
                    zh: 'Á±≥ÂºÄÊúóÂü∫ÁΩóÂú®1508Âπ¥Ëá≥1512Âπ¥Èó¥ÁªòÂà∂‰∫ÜË•øÊñØÂª∑ÊïôÂ†ÇÁöÑÂ§©Ëä±Êùø„ÄÇ',
                    ja: '„Éü„Ç±„É©„É≥„Ç∏„Çß„É≠„ÅØ1508Âπ¥„Åã„Çâ1512Âπ¥„ÅÆÈñì„Å´„Ç∑„Çπ„ÉÜ„Ç£„Éº„ÉäÁ§ºÊãùÂ†Ç„ÅÆÂ§©‰∫ï„ÇíÊèè„Åç„Åæ„Åó„Åü„ÄÇ'
                },
                difficulty: 1
            },
            {
                civilizations: ['Industrial Revolution'],
                era: 'Modern World',
                question: {
                    en: 'Which invention is considered to have started the Industrial Revolution?',
                    zh: 'Âì™È°πÂèëÊòéË¢´ËÆ§‰∏∫ÂºÄÂêØ‰∫ÜÂ∑•‰∏öÈù©ÂëΩÔºü',
                    ja: 'Áî£Ê•≠Èù©ÂëΩ„ÅÆÂßã„Åæ„Çä„Å®„Åï„Çå„ÇãÁô∫Êòé„ÅØ„Å©„ÇåÔºü'
                },
                choices: {
                    en: ['Steam Engine', 'Spinning Jenny', 'Power Loom', 'Cotton Gin'],
                    zh: ['Ëí∏Ê±ΩÊú∫', 'ÁèçÂ¶ÆÁ∫∫Á∫±Êú∫', 'Âä®ÂäõÁªáÂ∏ÉÊú∫', 'ËΩßÊ£âÊú∫'],
                    ja: ['Ëí∏Ê∞óÊ©üÈñ¢', '„Ç∏„Çß„Éã„ÉºÁ¥°Á∏æÊ©ü', 'ÂäõÁπîÊ©ü', 'Á∂øÁπ∞„ÇäÊ©ü']
                },
                answer: 1,
                explanation: {
                    en: 'The Spinning Jenny, invented by James Hargreaves in 1764, revolutionized textile production.',
                    zh: '1764Âπ¥Áî±Ë©πÂßÜÊñØ¬∑ÂìàÊ†ºÈáåÂ§´ÊñØÂèëÊòéÁöÑÁèçÂ¶ÆÁ∫∫Á∫±Êú∫ÂΩªÂ∫ïÊîπÂèò‰∫ÜÁ∫∫ÁªáÁîü‰∫ß„ÄÇ',
                    ja: '1764Âπ¥„Å´„Ç∏„Çß„Éº„É†„Ç∫„Éª„Éè„Éº„Ç∞„É™„Éº„Éñ„Çπ„Å´„Çà„Å£„Å¶Áô∫Êòé„Åï„Çå„Åü„Ç∏„Çß„Éã„ÉºÁ¥°Á∏æÊ©ü„ÅØÁπäÁ∂≠ÁîüÁî£„Å´Èù©ÂëΩ„Çí„ÇÇ„Åü„Çâ„Åó„Åæ„Åó„Åü„ÄÇ'
                },
                difficulty: 2
            },
            {
                civilizations: ['World Wars'],
                era: 'Modern World',
                question: {
                    en: 'In which year did World War I begin?',
                    zh: 'Á¨¨‰∏ÄÊ¨°‰∏ñÁïåÂ§ßÊàòÂú®Âì™‰∏ÄÂπ¥ÂºÄÂßãÔºü',
                    ja: 'Á¨¨‰∏ÄÊ¨°‰∏ñÁïåÂ§ßÊà¶„ÅØ‰ΩïÂπ¥„Å´Âßã„Åæ„Å£„ÅüÔºü'
                },
                choices: {
                    en: ['1912', '1914', '1916', '1918'],
                    zh: ['1912Âπ¥', '1914Âπ¥', '1916Âπ¥', '1918Âπ¥'],
                    ja: ['1912Âπ¥', '1914Âπ¥', '1916Âπ¥', '1918Âπ¥']
                },
                answer: 1,
                explanation: {
                    en: 'World War I began in 1914 after the assassination of Archduke Franz Ferdinand.',
                    zh: 'Á¨¨‰∏ÄÊ¨°‰∏ñÁïåÂ§ßÊàòÂú®1914Âπ¥ÂºóÊúóËå®¬∑ÊñêËø™ÂçóÂ§ßÂÖ¨ÈÅáÂà∫ÂêéÂºÄÂßã„ÄÇ',
                    ja: 'Á¨¨‰∏ÄÊ¨°‰∏ñÁïåÂ§ßÊà¶„ÅØ1914Âπ¥„Å´„Éï„É©„É≥„ÉÑ„Éª„Éï„Çß„É´„Éá„Ç£„Éä„É≥„ÉàÂ§ßÂÖ¨„ÅÆÊöóÊÆ∫Âæå„Å´Âßã„Åæ„Çä„Åæ„Åó„Åü„ÄÇ'
                },
                difficulty: 1
            },
            {
                civilizations: ['Ancient Egypt'],
                era: 'Ancient Civilizations',
                question: {
                    en: 'Which pharaoh\'s tomb was discovered by Howard Carter in 1922?',
                    zh: 'ÈúçÂçéÂæ∑¬∑Âç°ÁâπÂú®1922Âπ¥ÂèëÁé∞‰∫ÜÂì™‰ΩçÊ≥ïËÄÅÁöÑÈôµÂ¢ìÔºü',
                    ja: '„Éè„ÉØ„Éº„Éâ„Éª„Ç´„Éº„Çø„Éº„Åå1922Âπ¥„Å´Áô∫Ë¶ã„Åó„Åü„Éï„Ç°„É©„Ç™„ÅÆÂ¢ì„ÅØË™∞„ÅÆ„ÇÇ„ÅÆÔºü'
                },
                choices: {
                    en: ['Ramses II', 'Tutankhamun', 'Cleopatra', 'Nefertiti'],
                    zh: ['ÊãâÁæéË•øÊñØ‰∫å‰∏ñ', 'ÂõæÂù¶Âç°Ëíô', 'ÂÖãÂà©Â••Â∏ïÁâπÊãâ', 'Á∫≥ËäôËíÇËíÇ'],
                    ja: ['„É©„É†„Çª„Çπ2‰∏ñ', '„ÉÑ„Çø„É≥„Ç´„Éº„É°„É≥', '„ÇØ„É¨„Ç™„Éë„Éà„É©', '„Éç„Éï„Çß„É´„ÉÜ„Ç£„ÉÜ„Ç£']
                },
                answer: 1,
                explanation: {
                    en: 'Tutankhamun\'s tomb was discovered in 1922, one of the most significant archaeological finds.',
                    zh: 'ÂõæÂù¶Âç°ËíôÁöÑÈôµÂ¢ìÂú®1922Âπ¥Ë¢´ÂèëÁé∞ÔºåËøôÊòØÊúÄÈáçË¶ÅÁöÑËÄÉÂè§ÂèëÁé∞‰πã‰∏Ä„ÄÇ',
                    ja: '„ÉÑ„Çø„É≥„Ç´„Éº„É°„É≥„ÅÆÂ¢ì„ÅØ1922Âπ¥„Å´Áô∫Ë¶ã„Åï„Çå„ÄÅÊúÄ„ÇÇÈáçË¶Å„Å™ËÄÉÂè§Â≠¶ÁöÑÁô∫Ë¶ã„ÅÆ‰∏Ä„Å§„Å®„Å™„Çä„Åæ„Åó„Åü„ÄÇ'
                },
                difficulty: 1
            },
            {
                civilizations: ['Ancient India'],
                era: 'Ancient Civilizations',
                question: {
                    en: 'Which ancient Indian text is considered the oldest religious text in the world?',
                    zh: 'Âì™ÈÉ®Âè§Âç∞Â∫¶ÊñáÁåÆË¢´ËÆ§‰∏∫ÊòØ‰∏ñÁïå‰∏äÊúÄÂè§ËÄÅÁöÑÂÆóÊïôÊñáÁåÆÔºü',
                    ja: '‰∏ñÁïåÊúÄÂè§„ÅÆÂÆóÊïôÊñáÊõ∏„Å®„Åï„Çå„ÇãÂè§‰ª£„Ç§„É≥„Éâ„ÅÆÊñáÁåÆ„ÅØ„Å©„ÇåÔºü'
                },
                choices: {
                    en: ['Mahabharata', 'Ramayana', 'Rigveda', 'Bhagavad Gita'],
                    zh: ['Êë©ËØÉÂ©ÜÁΩóÂ§ö', 'ÁΩóÊë©Ë°çÈÇ£', 'Ê¢®‰ø±Âê†ÈôÄ', 'ËñÑ‰ºΩÊ¢µÊ≠å'],
                    ja: ['„Éû„Éè„Éº„Éê„Éº„É©„Çø', '„É©„Éº„Éû„Éº„É§„Éä', '„É™„Ç∞„Éª„É¥„Çß„Éº„ÉÄ', '„Éê„Ç¨„É¥„Ç°„ÉÉ„Éâ„Éª„ÇÆ„Éº„Çø„Éº']
                },
                answer: 2,
                explanation: {
                    en: 'The Rigveda, composed around 1500 BCE, is the oldest known religious text.',
                    zh: 'Ê¢®‰ø±Âê†ÈôÄÂàõ‰Ωú‰∫éÂÖ¨ÂÖÉÂâç1500Âπ¥Â∑¶Âè≥ÔºåÊòØÂ∑≤Áü•ÊúÄÂè§ËÄÅÁöÑÂÆóÊïôÊñáÁåÆ„ÄÇ',
                    ja: '„É™„Ç∞„Éª„É¥„Çß„Éº„ÉÄ„ÅØÁ¥ÄÂÖÉÂâç1500Âπ¥È†É„Å´‰Ωú„Çâ„Çå„ÄÅÊó¢Áü•„ÅÆÊúÄÂè§„ÅÆÂÆóÊïôÊñáÊõ∏„Åß„Åô„ÄÇ'
                },
                difficulty: 2
            }
        ];

        // Initialize Game
        function initGame() {
            loadSettings();
            updateUI();
            updateTimeline();
            initMentorButtons();
            if (musicEnabled) {
                document.getElementById('bg-music').play().catch(e => console.log("Autoplay prevented:", e));
            }
            loadAchievements();
            updateAchievementsDisplay();
            // Initialize score display
            document.getElementById('score').textContent = `${translations.score[language]}: ${score}`;
            document.getElementById('leaderboard').textContent = `${translations.highScore[language]}: ${highScore}`;
        }

        // Load Settings
        function loadSettings() {
            const savedMusic = localStorage.getItem('musicEnabled_1.0');
            const savedSound = localStorage.getItem('soundEnabled_1.0');
            const savedTimer = localStorage.getItem('timerEnabled_1.0');
            const savedDifficulty = localStorage.getItem('difficulty_1.0');
            const savedLanguage = localStorage.getItem('language_1.0');
            
            if (savedMusic !== null) musicEnabled = savedMusic === 'true';
            if (savedSound !== null) soundEnabled = savedSound === 'true';
            if (savedTimer !== null) timerEnabled = savedTimer === 'true';
            if (savedDifficulty !== null) difficulty = savedDifficulty;
            if (savedLanguage !== null) language = savedLanguage;
            
            document.getElementById('music-toggle').textContent = musicEnabled ? 'üéµ' : 'üîá';
            document.getElementById('sound-toggle').textContent = soundEnabled ? 'üîä' : 'üîá';
            document.getElementById('question-timer').style.display = timerEnabled ? 'block' : 'none';
            document.getElementById('difficulty-select').value = difficulty;
            updateUI();
        }

        // Save Settings
        function saveSettings() {
            localStorage.setItem('musicEnabled_1.0', musicEnabled);
            localStorage.setItem('soundEnabled_1.0', soundEnabled);
            localStorage.setItem('timerEnabled_1.0', timerEnabled);
            localStorage.setItem('difficulty_1.0', difficulty);
            localStorage.setItem('language_1.0', language);
        }

        // Load Achievements
        function loadAchievements() {
            const savedAchievements = localStorage.getItem('achievements_1.0');
            if (savedAchievements) {
                const parsed = JSON.parse(savedAchievements);
                for (const key in parsed) {
                    if (achievements[key]) {
                        achievements[key].earned = parsed[key].earned;
                    }
                }
            }
        }

        // Save Achievements
        function saveAchievements() {
            localStorage.setItem('achievements_1.0', JSON.stringify(achievements));
        }

        // Play Sound
        function playSound(soundId) {
            if (!soundEnabled && soundId !== 'bg-music') return;
            if (!musicEnabled && soundId === 'bg-music') return;
            const sound = document.getElementById(soundId);
            sound.currentTime = 0;
            sound.play().catch(e => console.log("Audio play failed:", e));
        }

        // Toggle Music
        function toggleMusic() {
            musicEnabled = !musicEnabled;
            const music = document.getElementById('bg-music');
            if (musicEnabled) {
                music.play();
                document.getElementById('music-toggle').textContent = 'üéµ';
                document.getElementById('music-toggle-setting').textContent = translations.musicLabel[language] + ': ' + translations.disable[language];
            } else {
                music.pause();
                document.getElementById('music-toggle').textContent = 'üîá';
                document.getElementById('music-toggle-setting').textContent = translations.musicLabel[language] + ': ' + translations.enable[language];
            }
            saveSettings();
            playSound('button-sound');
        }

        // Toggle Sound
        function toggleSound() {
            soundEnabled = !soundEnabled;
            document.getElementById('sound-toggle').textContent = soundEnabled ? 'üîä' : 'üîá';
            document.getElementById('sound-toggle-setting').textContent = translations.soundLabel[language] + ': ' + (soundEnabled ? translations.disable[language] : translations.enable[language]);
            saveSettings();
            playSound('button-sound');
        }

        // Toggle Timer
        function toggleTimer() {
            timerEnabled = !timerEnabled;
            document.getElementById('question-timer').style.display = timerEnabled ? 'block' : 'none';
            document.getElementById('timer-toggle-setting').textContent = translations.timerLabel[language] + ': ' + (timerEnabled ? translations.disable[language] : translations.enable[language]);
            saveSettings();
            playSound('button-sound');
        }

        // Set Difficulty
        function setDifficulty() {
            difficulty = document.getElementById('difficulty-select').value;
            saveSettings();
            playSound('button-sound');
        }

        // Show Settings Panel
        function showSettings() {
            document.getElementById('settings-panel').style.display = 'block';
            document.getElementById('settings-backdrop').style.display = 'block';
            playSound('button-sound');
        }

        // Hide Settings Panel
        function hideSettings() {
            document.getElementById('settings-panel').style.display = 'none';
            document.getElementById('settings-backdrop').style.display = 'none';
            playSound('button-sound');
        }

        // Toggle Achievements Panel
        function toggleAchievements() {
            const panel = document.getElementById('achievements');
            panel.style.display = panel.style.display === 'block' ? 'none' : 'block';
            playSound('button-sound');
        }

        // Update Achievements Display
        function updateAchievementsDisplay() {
            const list = document.getElementById('achievements-list');
            list.innerHTML = '';
            for (const key in achievements) {
                const achievement = achievements[key];
                const item = document.createElement('div');
                item.className = 'achievement-item';
                const icon = document.createElement('span');
                icon.className = 'achievement-icon';
                icon.textContent = achievement.earned ? 'üèÜ' : 'üîí';
                item.appendChild(icon);
                const text = document.createElement('div');
                const name = document.createElement('strong');
                name.textContent = achievement.name[language];
                text.appendChild(name);
                const desc = document.createElement('div');
                desc.style.fontSize = '14px';
                desc.style.color = '#7f8c8d';
                desc.textContent = achievement.desc[language];
                text.appendChild(desc);
                item.appendChild(text);
                list.appendChild(item);
            }
        }

        // Check and Unlock Achievements
        function checkAchievements() {
            if (totalQuestionsAnswered === 1 && !achievements.firstAnswer.earned) {
                achievements.firstAnswer.earned = true;
                showAchievementUnlocked('firstAnswer');
            }
            if (currentStreak >= 5 && !achievements.fiveStreak.earned) {
                achievements.fiveStreak.earned = true;
                showAchievementUnlocked('fiveStreak');
            }
            const allCivilizations = Array.from(new Set(questions.flatMap(q => q.civilizations)));
            if (unlockedCivilizations.length === allCivilizations.length && 
                currentEra === eras[eras.length - 1].name[language] && 
                !achievements.unlockAll.earned) {
                achievements.unlockAll.earned = true;
                showAchievementUnlocked('unlockAll');
            }
            if (score >= 1000 && !achievements.perfectScore.earned) {
                achievements.perfectScore.earned = true;
                showAchievementUnlocked('perfectScore');
            }
            if (totalQuestionsAnswered >= 50 && !achievements.historyBuff.earned) {
                achievements.historyBuff.earned = true;
                showAchievementUnlocked('historyBuff');
            }
            saveAchievements();
            updateAchievementsDisplay();
        }

        // Show Achievement Unlocked Notification
        function showAchievementUnlocked(achievementKey) {
            const achievement = achievements[achievementKey];
            const notification = document.getElementById('unlock-notification');
            notification.textContent = translations.achievementUnlocked[language].replace('{name}', achievement.name[language]);
            notification.style.display = 'block';
            playSound('achievement-sound');
            setTimeout(() => {
                notification.style.display = 'none';
            }, 2500);
        }

        // Set Language
        function setLanguage(lang) {
            language = lang;
            playSound('page-sound');
            updateUI();
            if (currentQuestion) {
                displayQuestion(currentQuestion);
            }
            saveSettings();
        }

        // Update UI
        function updateUI() {
            document.getElementById('title').textContent = translations.title[language];
            document.getElementById('next-question').textContent = translations.newQuestion[language];
            document.getElementById('hint-button').textContent = translations.hint[language];
            document.getElementById('reset-score').textContent = translations.resetScore[language];
            document.getElementById('score').textContent = `${translations.score[language]}: ${score}`;
            document.getElementById('leaderboard').textContent = `${translations.highScore[language]}: ${highScore}`;
            document.getElementById('streak-counter').textContent = `${translations.streak[language]}: ${currentStreak}`;
            document.getElementById('progress').textContent = `${translations.unlockedCivs[language]}: ${unlockedCivilizations.join(', ')}`;
            document.getElementById('era-info').textContent = `${translations.currentEra[language]}: ${eras.find(e => e.name.en === currentEra).name[language]}`;
            document.getElementById('question-counter').textContent = `${translations.questionsAnswered[language]}: ${totalQuestionsAnswered}`;
            document.getElementById('settings-title').textContent = translations.settings[language];
            document.getElementById('music-label').textContent = translations.musicLabel[language];
            document.getElementById('sound-label').textContent = translations.soundLabel[language];
            document.getElementById('timer-label').textContent = translations.timerLabel[language];
            document.getElementById('difficulty-label').textContent = translations.difficultyLabel[language];
            document.getElementById('achievements-title').textContent = translations.achievements[language];
            document.getElementById('music-toggle-setting').textContent = translations.musicLabel[language] + ': ' + (musicEnabled ? translations.disable[language] : translations.enable[language]);
            document.getElementById('sound-toggle-setting').textContent = translations.soundLabel[language] + ': ' + (soundEnabled ? translations.disable[language] : translations.enable[language]);
            document.getElementById('timer-toggle-setting').textContent = translations.timerLabel[language] + ': ' + (timerEnabled ? translations.disable[language] : translations.enable[language]);
            const timelineLabels = document.getElementById('timeline-labels');
            timelineLabels.innerHTML = '';
            eras.forEach(era => {
                const label = document.createElement('span');
                label.textContent = era.name[language].substring(0, 2);
                timelineLabels.appendChild(label);
            });
            updateMentorInfo();
        }

        // Update Mentor Information
        function updateMentorInfo() {
            const mentorDiv = document.getElementById('mentor');
            if (currentMentor) {
                mentorDiv.innerHTML = 
                    `${translations.mentor[language]}: ${currentMentor.name[language]}<br>` +
                    `<img id="mentor-img" src="${currentMentor.img}" alt="${currentMentor.name[language]}">` +
                    `<div style="font-style:italic; margin-top:5px;">${currentMentor.quote[language]}</div>`;
                document.getElementById('mentor-img').style.display = 'block';
                document.getElementById('mentor-bonus').textContent = `${translations.mentorBonus[language]}: x${currentMentor.bonus}`;
            } else {
                mentorDiv.innerHTML = 
                    `${translations.mentorNotSelected[language]}<br>` +
                    `<img id="mentor-img" src="" style="display: none;">`;
                document.getElementById('mentor-bonus').textContent = '';
            }
        }

        // Initialize Mentor Selection Buttons
        function initMentorButtons() {
            const mentorButtons = Object.keys(mentors).map(key => {
                return `<button onclick="selectMentor('${key}')" aria-label="Select ${mentors[key].name[language]}">${mentors[key].name[language]}</button>`;
            }).join('');
            document.getElementById('mentor').innerHTML += `<br>${translations.selectMentor[language]}: ${mentorButtons}`;
        }

        // Select Mentor
        function selectMentor(mentorKey) {
            currentMentor = mentors[mentorKey];
            playSound('button-sound');
            updateUI();
            const mentorDiv = document.getElementById('mentor');
            mentorDiv.classList.add('pulse');
            setTimeout(() => {
                mentorDiv.classList.remove('pulse');
            }, 1500);
        }

        // Start Timer
        function startTimer() {
            if (!timerEnabled) return;
            clearInterval(timerInterval);
            const timerBar = document.getElementById('timer-bar');
            timerBar.style.width = '100%';
            timerBar.style.transition = 'none';
            timerBar.offsetHeight;
            timerBar.style.transition = 'width 15s linear';
            timerBar.style.width = '0%';
            timerInterval = setTimeout(() => {
                if (currentQuestion) {
                    checkAnswer(-1);
                }
            }, 15000);
        }

        // Debounce Function
        function debounce(func, wait) {
            let timeout;
            return function (...args) {
                clearTimeout(timeout);
                timeout = setTimeout(() => func.apply(this, args

), wait);
            };
        }

        // Get New Question
        function nextQuestion() {
            if (isProcessing) return;
            isProcessing = true;
            document.getElementById('next-question').disabled = true;
            playSound('page-sound');
            clearInterval(timerInterval);
            
            let availableQuestions = questions.filter(q => 
                q.civilizations.some(c => unlockedCivilizations.includes(c)) && 
                eras.find(e => e.name.en === currentEra).civilizations.some(c => q.civilizations.includes(c)) &&
                (!q.unlockRequirement || correctAnswers >= q.unlockRequirement) &&
                !questionHistory.includes(q.question.en)
            );

            if (availableQuestions.length === 0) {
                questionHistory = [];
                availableQuestions = questions.filter(q => 
                    q.civilizations.some(c => unlockedCivilizations.includes(c)) && 
                    eras.find(e => e.name.en === currentEra).civilizations.some(c => q.civilizations.includes(c)) &&
                    (!q.unlockRequirement || correctAnswers >= q.unlockRequirement)
                );
            }

            availableQuestions = availableQuestions.filter(q => {
                if (difficulty === 'easy') return q.difficulty === 1;
                if (difficulty === 'hard') return q.difficulty === 2;
                return true;
            });

            if (availableQuestions.length === 0) {
                document.getElementById('question').textContent = translations.noQuestions[language];
                isProcessing = false;
                document.getElementById('next-question').disabled = false;
                return;
            }

            let filteredQuestions = availableQuestions;
            if (currentMentor) {
                const mentorSpecialtyQuestions = availableQuestions.filter(q => 
                    q.civilizations.some(c => currentMentor.specialty.includes(c))
                );
                if (mentorSpecialtyQuestions.length > 0) {
                    filteredQuestions = mentorSpecialtyQuestions;
                }
            }

            const randomIndex = Math.floor(Math.random() * filteredQuestions.length);
            currentQuestion = filteredQuestions[randomIndex];
            
            questionHistory.push(currentQuestion.question.en);
            if (questionHistory.length > 10) {
                questionHistory.shift();
            }

            displayQuestion(currentQuestion);
            document.getElementById('result').textContent = '';
            document.getElementById('explanation').textContent = '';
            document.getElementById('hint').textContent = '';
            updateTimeline();
            startTimer();
            isProcessing = false;
            document.getElementById('next-question').disabled = false;
        }

        const debouncedNextQuestion = debounce(nextQuestion, 300);

        // Display Question
        function displayQuestion(question) {
            document.getElementById('question').textContent = question.question[language] || question.question.en;
            const choicesDiv = document.getElementById('choices');
            choicesDiv.innerHTML = '';
            const tagsDiv = document.createElement('div');
            tagsDiv.style.margin = '10px 0';
            question.civilizations.forEach(civ => {
                const tag = document.createElement('span');
                tag.className = 'civilization-tag';
                tag.textContent = civ;
                const difficultyIndicator = document.createElement('span');
                difficultyIndicator.className = `difficulty-indicator difficulty-${question.difficulty === 1 ? 'easy' : question.difficulty === 2 ? 'hard' : 'medium'}`;
                tag.appendChild(difficultyIndicator);
                tagsDiv.appendChild(tag);
            });
            choicesDiv.appendChild(tagsDiv);
            (question.choices[language] || question.choices.en).forEach((choice, index) => {
                const button = document.createElement('button');
                button.textContent = choice;
                button.onclick = () => {
                    if (!button.disabled) {
                        clearInterval(timerInterval);
                        checkAnswer(index);
                    }
                };
                button.setAttribute('aria-label', `Option ${choice}`);
                choicesDiv.appendChild(button);
            });
        }

        // Check Answer
        function checkAnswer(selectedIndex) {
            const choices = document.querySelectorAll('#choices button');
            totalQuestionsAnswered++;
            choices.forEach(button => button.disabled = true);
            if (selectedIndex === currentQuestion.answer) {
                currentStreak++;
                if (currentStreak > highestStreak) {
                    highestStreak = currentStreak;
                }
                let points = 10 * currentStreak;
                if (currentMentor) {
                    const isSpecialty = currentQuestion.civilizations.some(c => 
                        currentMentor.specialty.includes(c)
                    );
                    points = Math.floor(points * (isSpecialty ? currentMentor.bonus * 1.2 : currentMentor.bonus));
                }
                score += points;
                localStorage.setItem('score_1.0', score);
                playSound('correct-sound');
                if (selectedIndex >= 0) {
                    choices[selectedIndex].classList.add('correct');
                }
                document.getElementById('result').textContent = translations.correct[language]
                    .replace('{points}', points)
                    .replace('{streak}', currentStreak);
                document.getElementById('result').style.color = '#27ae60';
                if (currentStreak >= 3) {
                    playSound('streak-sound');
                    document.getElementById('streak-counter').style.color = '#e74c3c';
                    document.getElementById('streak-counter').style.fontWeight = 'bold';
                }
                correctAnswers++;
                checkForUnlocks();
            } else {
                currentStreak = 0;
                playSound('wrong-sound');
                if (selectedIndex >= 0) {
                    choices[selectedIndex].classList.add('wrong');
                }
                choices[currentQuestion.answer].classList.add('correct');
                document.getElementById('result').textContent = translations.wrong[language];
                document.getElementById('result').style.color = '#e74c3c';
                document.getElementById